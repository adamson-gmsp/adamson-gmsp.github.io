)
V5 = vital %>%
select(c(1:1,31:36,41:41))
V5 = V5 %>%
mutate_at(c(2:8), as.numeric)
V5_col1 = colnames(V5)
V5_col1 = sub("\\\r.*", "", V5_col1)
colnames(V5) = V5_col1
V5_col2 = V5 %>%
select(c(2)) %>%
colnames()
names(V5)[names(V5) == V5_col2] <- 'NA2015'
V5_col2 = gsub("[[:digit:]]", "", V5_col2)
V5 = V5 %>%
mutate(topic = "Vital", ind = "Total Jobs")
V5_col3 = colnames(V5)
V5_col3 <- word(V5_col3, 1)
colnames(V5) = V5_col3
V5 = V5 %>%
mutate(RK2015 = rank(desc(-NA2015),ties.method = "min"),
RK2016 = rank(desc(-NA2016),ties.method = "min"),
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2020),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V5"
)
V6 = vital %>%
select(c(1:1,44:50))
V6 = V6 %>%
mutate_at(c(2:8), as.numeric)
V6_col1 = colnames(V6)
V6_col1 = sub("\\\r.*", "", V6_col1)
colnames(V6) = V6_col1
V6_col2 = V6 %>%
select(c(2)) %>%
colnames()
names(V6)[names(V6) == V6_col2] <- 'NA2015'
V6_col2 = gsub("[[:digit:]]", "", V6_col2)
V6 = V6 %>%
mutate(topic = "Vital", ind = "Unemployment Rate Annualized")
V6_col3 = colnames(V6)
V6_col3 <- word(V6_col3, 1)
colnames(V6) = V6_col3
V6 = V6 %>%
mutate(RK2015 = rank(desc(NA2015),ties.method = "min"),
RK2016 = rank(desc(NA2016),ties.method = "min"),
RK2017 = rank(desc(NA2017),ties.method = "min"),
RK2018 = rank(desc(NA2018),ties.method = "min"),
RK2019 = rank(desc(NA2019),ties.method = "min"),
RK2020 = rank(desc(NA2020),ties.method = "min"),
RK2021 = rank(desc(NA2021),ties.method = "min"),
code = "V6"
)
V7 = vital %>%
select(c(1:1,51:57))
V7 = V7 %>%
mutate_at(c(2:8), as.numeric)
V7_col1 = colnames(V7)
V7_col1 = sub("\\\r.*", "", V7_col1)
colnames(V7) = V7_col1
V7_col2 = V7 %>%
select(c(2)) %>%
colnames()
names(V7)[names(V7) == V7_col2] <- 'NA2015'
V7_col2 = gsub("[[:digit:]]", "", V7_col2)
V7 = V7 %>%
mutate(topic = "Vital", ind = V7_col2)
V7_col3 = colnames(V7)
V7_col3 <- word(V7_col3, 1)
colnames(V7) = V7_col3
V7 = V7 %>%
mutate(RK2015 = rank(desc(-NA2015),ties.method = "min"),
RK2016 = rank(desc(-NA2016),ties.method = "min"),
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2019),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V7"
)
V8 = vital %>%
select(c(1:1,58:64))
V8 = V8 %>%
mutate_at(c(2:8), as.numeric)
V8_col1 = colnames(V8)
V8_col1 = sub("\\\r.*", "", V8_col1)
colnames(V8) = V8_col1
V8_col2 = V8 %>%
select(c(2)) %>%
colnames()
names(V8)[names(V8) == V8_col2] <- 'NA2015'
V8_col2 = gsub("[[:digit:]]", "", V8_col2)
V8 = V8 %>%
mutate(topic = "Vital", ind = V8_col2)
V8_col3 = colnames(V8)
V8_col3 <- word(V8_col3, 1)
colnames(V8) = V8_col3
V8 = V8 %>%
mutate(RK2015 = rank(desc(-NA2015),ties.method = "min"),
RK2016 = rank(desc(-NA2016),ties.method = "min"),
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2019),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V8"
)
V9 = vital %>%
select(c(1:1,65:71))
V9 = V9 %>%
mutate_at(c(2:8), as.numeric)
V9_col1 = colnames(V9)
V9_col1 = sub("\\\r.*", "", V9_col1)
colnames(V9) = V9_col1
V9_col2 = V9 %>%
select(c(2)) %>%
colnames()
names(V9)[names(V9) == V9_col2] <- 'NA2015'
V9_col2 = gsub("[[:digit:]]", "", V9_col2)
V9 = V9 %>%
mutate(topic = "Vital", ind = "Poverty Rate - White")
V9_col3 = colnames(V9)
V9_col3 <- word(V9_col3, 1)
colnames(V9) = V9_col3
V9 = V9 %>%
mutate(RK2015 = rank(desc(-NA2015),ties.method = "min"),
RK2016 = rank(desc(-NA2016),ties.method = "min"),
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2020),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V9"
)
V10 = vital %>%
select(c(1:1,72:78))
V10 = V10 %>%
mutate_at(c(2:8), as.numeric)
V10_col1 = colnames(V10)
V10_col1 = sub("\\\r.*", "", V10_col1)
colnames(V10) = V10_col1
V10_col2 = V10 %>%
select(c(2)) %>%
colnames()
names(V10)[names(V10) == V10_col2] <- 'NA2015'
V10_col2 = gsub("[[:digit:]]", "", V10_col2)
V10 = V10 %>%
mutate(topic = "Vital", ind = "Poverty Rate - Of Color")
V10_col3 = colnames(V10)
V10_col3 <- word(V10_col3, 1)
colnames(V10) = V10_col3
V10 = V10 %>%
mutate(RK2015 = rank(desc(NA2015),ties.method = "min"),
RK2016 = rank(desc(NA2016),ties.method = "min"),
RK2017 = rank(desc(NA2017),ties.method = "min"),
RK2018 = rank(desc(NA2018),ties.method = "min"),
RK2019 = rank(desc(NA2019),ties.method = "min"),
RK2020 = rank(desc(NA2020),ties.method = "min"),
RK2021 = rank(desc(NA2021),ties.method = "min"),
code = "V10"
)
V11 = vital %>%
select(c(1:1,79:85))
V11 = V11 %>%
mutate_at(c(2:8), as.numeric)
V11_col1 = colnames(V11)
V11_col1 = sub("\\\r.*", "", V11_col1)
colnames(V11) = V11_col1
V11_col2 = V11 %>%
select(c(2)) %>%
colnames()
names(V11)[names(V11) == V11_col2] <- 'NA2015'
V11_col2 = gsub("[[:digit:]]", "", V11_col2)
V11 = V11 %>%
mutate(topic = "Vital", ind = "Population")
V11_col3 = colnames(V11)
V11_col3 <- word(V11_col3, 1)
colnames(V11) = V11_col3
V11 = V11 %>%
mutate(RK2015 = rank(desc(NA2015),ties.method = "min"),
RK2016 = rank(desc(NA2016),ties.method = "min"),
RK2017 = rank(desc(NA2017),ties.method = "min"),
RK2018 = rank(desc(NA2018),ties.method = "min"),
RK2019 = rank(desc(NA2019),ties.method = "min"),
RK2020 = rank(desc(NA2020),ties.method = "min"),
RK2021 = rank(desc(NA2021),ties.method = "min"),
code = "V11"
)
V12 = vital %>%
select(c(1:1,86:92))
V12 = V12 %>%
mutate_at(c(2:8), as.numeric)
V12_col1 = colnames(V12)
V12_col1 = sub("\\\r.*", "", V12_col1)
colnames(V12) = V12_col1
V12_col2 = V12 %>%
select(c(2)) %>%
colnames()
names(V12)[names(V12) == V12_col2] <- 'NA2015'
V12_col2 = gsub("[[:digit:]]", "", V12_col2)
V12 = V12 %>%
mutate(topic = "Vital", ind = "Population Growth")
V12_col3 = colnames(V12)
V12_col3 <- word(V12_col3, 1)
colnames(V12) = V12_col3
V12 = V12 %>%
mutate(RK2015 = rank(desc(-NA2015),ties.method = "min"),
RK2016 = rank(desc(-NA2016),ties.method = "min"),
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2020),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V12"
)
V13 = vital %>%
select(c(1:1,93:99))
V13 = V13 %>%
mutate_at(c(2:8), as.numeric)
V13_col1 = colnames(V13)
V13_col1 = sub("\\\r.*", "", V13_col1)
colnames(V13) = V13_col1
V13_col2 = V13 %>%
select(c(2)) %>%
colnames()
names(V13)[names(V13) == V13_col2] <- 'NA2015'
V13_col2 = gsub("[[:digit:]]", "", V13_col2)
V13 = V13 %>%
mutate(topic = "Vital", ind = "Population of Color")
V13_col3 = colnames(V13)
V13_col3 <- word(V13_col3, 1)
colnames(V13) = V13_col3
V13 = V13 %>%
mutate(RK2015 = NA,
RK2016 = NA,
RK2017 = rank(desc(-NA2017),ties.method = "min"),
RK2018 = rank(desc(-NA2018),ties.method = "min"),
RK2019 = rank(desc(-NA2019),ties.method = "min"),
RK2020 = rank(desc(-NA2020),ties.method = "min"),
RK2021 = rank(desc(-NA2021),ties.method = "min"),
code = "V13"
)
I5$NA2020 =  ""
L1$NA2020 =  ""
L1$NA2021 =  ""
L3$NA2020 =  ""
L4$NA2020 =  ""
prior_yr = rbind(E1,E2,E3,E4,E5,E6,BV1,BV2,BV3,BV4,BV5,BV6,
EDU1,EDU2,EDU3,EDU4,EDU5,EDU6,EDU7,EDU8,EDU9,
ENV1,ENV2,ENV3,ENV4,ENV5,ENV6,
I1,I2,I3,I4,I5,I6,I1,
L1,L2,L3,L4,L5,L6,L7,L8,
T1,T2,T3,T4,T5,T6,
V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14)
prior_yr = prior_yr %>%
mutate_at(c(2:8,11:17), as.numeric) %>%
mutate(NA2022 = NA,
RK2022 = NA
)
prior_yr$MSA = "."
prior_yr$MSA[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "CBSA12060"
prior_yr$MSA[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "CBSA12420"
prior_yr$MSA[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "CBSA14460"
prior_yr$MSA[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "CBSA16740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "CBSA16980"
prior_yr$MSA[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "CBSA19100"
prior_yr$MSA[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "CBSA19740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "CBSA38300"
prior_yr$MSA[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "CBSA38900"
prior_yr$MSA[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "CBSA41860"
prior_yr$MSA[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "CBSA42660"
prior_yr$MSA[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "CBSA33460"
# save PY
write.csv(prior_yr,"2023/cca_temp/py_v1.csv", row.names = TRUE)
prior_yr <- read.csv("2023/cca_temp/py_v1.csv") %>%
select(-X)
# import CY
cy <- read.csv("2023/cca_temp/cy_v1.csv") %>%
select(-X)
cy = cy %>% pivot_longer(cols=c(2:10),
names_to='code',
values_to='NA2023')
cca_data = merge(x=prior_yr,y=cy,by=c("MSA","code"),all.x=TRUE)
write.csv(cca_data,"2023/cca_temp/cca_data_v1.csv", row.names = TRUE)
cca_data <- read.csv("2023/cca_temp/cca_data_v1.csv") %>%
select(-X)
View(cca_data)
x_lines = cca_data %>%
filter(code=="E1") %>%
na.omit() %>%
ggplot( aes(x=year, y=value, group=region, color = Legend)) +
geom_line(aes(size=Legend)) +
geom_point(size = 1.8) +
scale_x_continuous(expand = c(0.04, 0), limits = c(2019, NA),
breaks = seq(2019, 2023, 1)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 0.35),
breaks = seq(0.05, 0.5, 0.05)) +
scale_color_manual(values=c(MSP='seagreen3', 'peer regions'='grey')) +
scale_size_manual(values = c(MSP=1.2, no=0.8))+
theme(
text = element_text(family = "Lato")
)
ggplotly(x_lines, tooltip = c("year", "region", "value"))
x_lines = cca_data %>%
filter(code=="E1") %>%
na.omit() %>%
ggplot( aes(x=year, y=value, group=MSA, color = Legend)) +
geom_line(aes(size=Legend)) +
geom_point(size = 1.8) +
scale_x_continuous(expand = c(0.04, 0), limits = c(2019, NA),
breaks = seq(2019, 2023, 1)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 0.35),
breaks = seq(0.05, 0.5, 0.05)) +
scale_color_manual(values=c(MSP='seagreen3', 'peer regions'='grey')) +
scale_size_manual(values = c(MSP=1.2, no=0.8))+
theme(
text = element_text(family = "Lato")
)
ggplotly(x_lines, tooltip = c("year", "region", "value"))
prior_yr = rbind(E1,E2,E3,E4,E5,E6,BV1,BV2,BV3,BV4,BV5,BV6,
EDU1,EDU2,EDU3,EDU4,EDU5,EDU6,EDU7,EDU8,EDU9,
ENV1,ENV2,ENV3,ENV4,ENV5,ENV6,
I1,I2,I3,I4,I5,I6,I1,
L1,L2,L3,L4,L5,L6,L7,L8,
T1,T2,T3,T4,T5,T6,
V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14)
prior_yr = prior_yr %>%
mutate_at(c(2:8,11:17), as.numeric) %>%
mutate(NA2022 = NA,
RK2022 = NA
)
prior_yr$MSA = "."
prior_yr$MSA[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "CBSA12060"
prior_yr$MSA[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "CBSA12420"
prior_yr$MSA[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "CBSA14460"
prior_yr$MSA[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "CBSA16740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "CBSA16980"
prior_yr$MSA[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "CBSA19100"
prior_yr$MSA[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "CBSA19740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "CBSA38300"
prior_yr$MSA[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "CBSA38900"
prior_yr$MSA[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "CBSA41860"
prior_yr$MSA[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "CBSA42660"
prior_yr$MSA[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "CBSA33460"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "Atlanta, GA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "Austin, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "Boston, MA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "Charlotte, NC"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "Chicago, IL"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "Dallas, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "Denver, CO"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "Pittsburgh, PA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "Portland, OR"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "San Francisco, CA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "Seattle, WA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "MSP"
# save PY
write.csv(prior_yr,"2023/cca_temp/py_v1.csv", row.names = TRUE)
prior_yr <- read.csv("2023/cca_temp/py_v1.csv") %>%
select(-X)
# import CY
cy <- read.csv("2023/cca_temp/cy_v1.csv") %>%
select(-X)
cy = cy %>% pivot_longer(cols=c(2:10),
names_to='code',
values_to='NA2023')
cca_data = merge(x=prior_yr,y=cy,by=c("MSA","code"),all.x=TRUE)
write.csv(cca_data,"2023/cca_temp/cca_data_v1.csv", row.names = TRUE)
cca_data <- read.csv("2023/cca_temp/cca_data_v1.csv") %>%
select(-X)
prior_yr = rbind(E1,E2,E3,E4,E5,E6,BV1,BV2,BV3,BV4,BV5,BV6,
EDU1,EDU2,EDU3,EDU4,EDU5,EDU6,EDU7,EDU8,EDU9,
ENV1,ENV2,ENV3,ENV4,ENV5,ENV6,
I1,I2,I3,I4,I5,I6,I1,
L1,L2,L3,L4,L5,L6,L7,L8,
T1,T2,T3,T4,T5,T6,
V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14)
prior_yr = prior_yr %>%
mutate_at(c(2:8,11:17), as.numeric) %>%
mutate(NA2022 = NA,
RK2022 = NA
)
prior_yr$MSA = "."
prior_yr$MSA[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "CBSA12060"
prior_yr$MSA[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "CBSA12420"
prior_yr$MSA[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "CBSA14460"
prior_yr$MSA[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "CBSA16740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "CBSA16980"
prior_yr$MSA[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "CBSA19100"
prior_yr$MSA[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "CBSA19740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "CBSA38300"
prior_yr$MSA[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "CBSA38900"
prior_yr$MSA[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "CBSA41860"
prior_yr$MSA[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "CBSA42660"
prior_yr$MSA[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "CBSA33460"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "Atlanta, GA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "Austin, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "Boston, MA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "Charlotte, NC"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "Chicago, IL"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "Dallas, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "Denver, CO"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "Pittsburgh, PA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "Portland, OR"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "San Francisco, CA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "Seattle, WA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "MSP"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "peer regions"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "MSP"
# save PY
write.csv(prior_yr,"2023/cca_temp/py_v1.csv", row.names = TRUE)
prior_yr <- read.csv("2023/cca_temp/py_v1.csv") %>%
select(-X)
# import CY
cy <- read.csv("2023/cca_temp/cy_v1.csv") %>%
select(-X)
cy = cy %>% pivot_longer(cols=c(2:10),
names_to='code',
values_to='NA2023')
cca_data = merge(x=prior_yr,y=cy,by=c("MSA","code"),all.x=TRUE)
write.csv(cca_data,"2023/cca_temp/cca_data_v1.csv", row.names = TRUE)
prior_yr = rbind(E1,E2,E3,E4,E5,E6,BV1,BV2,BV3,BV4,BV5,BV6,
EDU1,EDU2,EDU3,EDU4,EDU5,EDU6,EDU7,EDU8,EDU9,
ENV1,ENV2,ENV3,ENV4,ENV5,ENV6,
I1,I2,I3,I4,I5,I6,I1,
L1,L2,L3,L4,L5,L6,L7,L8,
T1,T2,T3,T4,T5,T6,
V1,V2,V3,V4,V5,V6,V7,V8,V9,V10,V11,V12,V13,V14)
prior_yr = prior_yr %>%
mutate_at(c(2:8,11:17), as.numeric) %>%
mutate(NA2022 = NA,
RK2022 = NA
)
prior_yr$MSA = "."
prior_yr$MSA[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "CBSA12060"
prior_yr$MSA[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "CBSA12420"
prior_yr$MSA[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "CBSA14460"
prior_yr$MSA[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "CBSA16740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "CBSA16980"
prior_yr$MSA[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "CBSA19100"
prior_yr$MSA[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "CBSA19740"
prior_yr$MSA[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "CBSA38300"
prior_yr$MSA[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "CBSA38900"
prior_yr$MSA[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "CBSA41860"
prior_yr$MSA[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "CBSA42660"
prior_yr$MSA[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "CBSA33460"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "Atlanta, GA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "Austin, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "Boston, MA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "Charlotte, NC"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "Chicago, IL"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "Dallas, TX"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "Denver, CO"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "Pittsburgh, PA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "Portland, OR"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "San Francisco, CA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "Seattle, WA"
prior_yr$MSA_name[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "MSP"
prior_yr$Legend[prior_yr$NAESTIMATES == "Atlanta-Sandy Springs-Roswell, GA Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Austin-Round Rock, TX Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Boston-Cambridge-Newton, MA-NH Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Charlotte-Concord-Gastonia, NC-SC Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Chicago-Naperville-Elgin, IL-IN-WI Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Dallas-Fort Worth-Arlington, TX Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Denver-Aurora-Lakewood, CO Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Pittsburgh, PA Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Portland-Vancouver-Hillsboro, OR-WA Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "San Francisco-Oakland-Hayward, CA Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Seattle-Tacoma-Bellevue, WA Metro Area"] <- "peer regions"
prior_yr$Legend[prior_yr$NAESTIMATES == "Minneapolis-St. Paul-Bloomington, MN-WI Metro Area"] <- "MSP"
# save PY
write.csv(prior_yr,"2023/cca_temp/py_v1.csv", row.names = TRUE)
prior_yr <- read.csv("2023/cca_temp/py_v1.csv") %>%
select(-X)
# import CY
cy <- read.csv("2023/cca_temp/cy_v1.csv") %>%
select(-X)
cy = cy %>% pivot_longer(cols=c(2:10),
names_to='code',
values_to='NA2023')
cca_data = merge(x=prior_yr,y=cy,by=c("MSA","code"),all.x=TRUE)
write.csv(cca_data,"2023/cca_temp/cca_data_v1.csv", row.names = TRUE)
cca_data <- read.csv("2023/cca_temp/cca_data_v1.csv") %>%
select(-X)
x_lines = cca_data %>%
filter(code=="E1") %>%
na.omit() %>%
ggplot( aes(x=year, y=value, group=MSA_name, color = Legend)) +
geom_line(aes(size=Legend)) +
geom_point(size = 1.8) +
scale_x_continuous(expand = c(0.04, 0), limits = c(2019, NA),
breaks = seq(2019, 2023, 1)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 0.35),
breaks = seq(0.05, 0.5, 0.05)) +
scale_color_manual(values=c(MSP='seagreen3', 'peer regions'='grey')) +
scale_size_manual(values = c(MSP=1.2, no=0.8))+
theme(
text = element_text(family = "Lato")
)
ggplotly(x_lines, tooltip = c("year", "region", "value"))
